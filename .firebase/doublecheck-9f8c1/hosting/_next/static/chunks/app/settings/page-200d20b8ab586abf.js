(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{1650:(e,t,a)=>{Promise.resolve().then(a.bind(a,7977))},7767:(e,t,a)=>{"use strict";a.d(t,{G:()=>n,deleteImage:()=>i,generateUniqueFilename:()=>o,isBlobUrl:()=>d,uploadImage:()=>l});var s=a(3314),r=a(6847);let l=async(e,t)=>{try{let a=(0,s.KR)(r.IG,t),l=await (0,s.D)(a,e);return await (0,s.qk)(l.ref)}catch(e){throw console.error("Error uploading image:",e),Error("Failed to upload image")}},i=async e=>{try{let t=new URL(e).pathname.match(/\/o\/(.+)/);if(!t)throw Error("Invalid storage URL");let a=t[1],l=decodeURIComponent(a),i=(0,s.KR)(r.IG,l);await (0,s.XR)(i)}catch(e){console.error("Error deleting image:",e)}},o=e=>{let t=Date.now(),a=Math.random().toString(36).substring(2,8),s=e.split(".").pop()||"jpg";return"".concat(t,"-").concat(a,".").concat(s)},n=e=>e.includes("firebasestorage.googleapis.com"),d=e=>e.startsWith("blob:")},7977:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(2221),r=a(1801),l=a(7386),i=a(7043),o=a(7127),n=a(2441),d=a(7933),c=a(8637),m=a.n(c),u=a(7767);function x(){let{user:e}=(0,i.A)(),{data:t,isLoading:a}=o.i.users.getProfile.useQuery(),{data:c=[],isLoading:x}=o.i.users.getMyProjects.useQuery(),b=o.i.users.updateProfile.useMutation({onSuccess:()=>{k("Profile updated successfully!"),setTimeout(()=>k(""),3e3)}}),[p,g]=(0,n.useState)({displayName:"",bio:"",website:"",socials:{twitter:"",instagram:"",linkedin:"",imdb:""}}),[f,h]=(0,n.useState)(null),[y,v]=(0,n.useState)(null),[j,N]=(0,n.useState)(!1),[w,k]=(0,n.useState)("");(0,n.useEffect)(()=>{if(t){var e,a,s,r;g({displayName:t.displayName||"",bio:t.bio||"",website:t.website||"",socials:{twitter:(null==(e=t.socials)?void 0:e.twitter)||"",instagram:(null==(a=t.socials)?void 0:a.instagram)||"",linkedin:(null==(s=t.socials)?void 0:s.linkedin)||"",imdb:(null==(r=t.socials)?void 0:r.imdb)||""}}),v(t.photoURL||null)}},[t]);let U=async a=>{a.preventDefault(),N(!0);try{let a=null,s=null==t?void 0:t.photoURL;if(f){let t=(0,u.generateUniqueFilename)(f.name),r="users/".concat(null==e?void 0:e.id,"/").concat(t);if(a=await (0,u.uploadImage)(f,r),s&&!(0,u.isBlobUrl)(s)&&s.includes("firebasestorage"))try{await (0,u.deleteImage)(s)}catch(e){console.log("Could not delete old image (may not be Firebase Storage URL)")}}else a=(null==t?void 0:t.photoURL)||null;await b.mutateAsync({displayName:p.displayName,photoURL:a||null,bio:p.bio||null,website:p.website||null,socials:{twitter:p.socials.twitter||null,instagram:p.socials.instagram||null,linkedin:p.socials.linkedin||null,imdb:p.socials.imdb||null}})}catch(e){console.error("Error updating profile:",e),alert("Failed to update profile. Please try again.")}finally{N(!1)}};return a?(0,s.jsx)(r.O,{children:(0,s.jsx)(l.N,{children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary"})})})}):(0,s.jsx)(r.O,{children:(0,s.jsx)(l.N,{children:(0,s.jsxs)("div",{className:"p-8 max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-2 text-text-primary",children:"Settings"}),(0,s.jsx)("p",{className:"text-text-secondary",children:"Manage your profile and preferences"})]}),w&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-green-500/10 border border-green-500/30 rounded-lg text-green-500",children:w}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"card-elevated p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-text-primary",children:"Profile Photo"}),(0,s.jsxs)("div",{className:"flex items-start gap-6",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:y?(0,s.jsx)("div",{className:"relative w-24 h-24 rounded-full overflow-hidden",children:(0,s.jsx)(d.default,{src:y,alt:p.displayName,fill:!0,className:"object-cover"})}):(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br ".concat((e=>{let t=["from-purple-500 to-pink-500","from-blue-500 to-cyan-500","from-green-500 to-emerald-500","from-orange-500 to-red-500","from-pink-500 to-rose-500","from-indigo-500 to-purple-500","from-cyan-500 to-blue-500","from-amber-500 to-orange-500"],a=e.split("").reduce((e,t)=>e+t.charCodeAt(0),0)%t.length;return t[a]})(p.displayName||"User")," flex items-center justify-center text-white text-2xl font-bold"),children:(p.displayName||"User").split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a&&a.type.startsWith("image/")){h(a);let e=new FileReader;e.onloadend=()=>{v(e.result)},e.readAsDataURL(a)}},className:"block w-full text-sm text-text-secondary file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-accent-primary file:text-white hover:file:bg-accent-hover file:cursor-pointer"}),(0,s.jsx)("p",{className:"text-xs text-text-tertiary mt-2",children:"JPG, PNG or GIF. Max size 5MB."})]})]})]}),(0,s.jsxs)("div",{className:"card-elevated p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-text-primary",children:"Basic Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Display Name"}),(0,s.jsx)("input",{type:"text",value:p.displayName,onChange:e=>g({...p,displayName:e.target.value}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Email"}),(0,s.jsx)("input",{type:"email",value:(null==t?void 0:t.email)||"",disabled:!0,className:"w-full px-4 py-2 bg-background-tertiary border border-border-default rounded-lg text-text-tertiary cursor-not-allowed"}),(0,s.jsx)("p",{className:"text-xs text-text-tertiary mt-1",children:"Email cannot be changed"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Bio"}),(0,s.jsx)("textarea",{value:p.bio,onChange:e=>g({...p,bio:e.target.value}),rows:4,className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary resize-none",placeholder:"Tell us about yourself..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Website"}),(0,s.jsx)("input",{type:"url",value:p.website,onChange:e=>g({...p,website:e.target.value}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"https://yourwebsite.com"})]})]})]}),(0,s.jsxs)("div",{className:"card-elevated p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-text-primary",children:"Social Links"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Twitter / X"}),(0,s.jsx)("input",{type:"text",value:p.socials.twitter,onChange:e=>g({...p,socials:{...p.socials,twitter:e.target.value}}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"@username"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Instagram"}),(0,s.jsx)("input",{type:"text",value:p.socials.instagram,onChange:e=>g({...p,socials:{...p.socials,instagram:e.target.value}}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"@username"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"LinkedIn"}),(0,s.jsx)("input",{type:"text",value:p.socials.linkedin,onChange:e=>g({...p,socials:{...p.socials,linkedin:e.target.value}}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"linkedin.com/in/username"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"IMDb"}),(0,s.jsx)("input",{type:"text",value:p.socials.imdb,onChange:e=>g({...p,socials:{...p.socials,imdb:e.target.value}}),className:"w-full px-4 py-2 bg-background-secondary border border-border-default rounded-lg text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary",placeholder:"imdb.com/name/..."})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",disabled:j||b.isPending,className:"px-6 py-3 bg-accent-primary text-white rounded-lg hover:bg-accent-hover transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",style:{color:"rgb(var(--colored-button-text))"},children:j||b.isPending?"Saving...":"Save Changes"})})]})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"card-elevated p-6 sticky top-8",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-text-primary",children:"My Projects"}),x?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-accent-primary"})}):0===c.length?(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:"No projects yet"}):(0,s.jsx)("div",{className:"space-y-3",children:c.map(e=>(0,s.jsx)(m(),{href:"/projects/".concat(e.id),className:"block p-3 rounded-lg border border-border-default hover:bg-background-tertiary transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[e.coverImageUrl?(0,s.jsx)("div",{className:"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0",children:(0,s.jsx)(d.default,{src:e.coverImageUrl,alt:e.title,fill:!0,className:"object-cover",sizes:"48px"})}):(0,s.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-600/20 to-purple-600/20 flex items-center justify-center text-xl flex-shrink-0",children:"\uD83D\uDCDD"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-medium text-text-primary truncate",children:e.title}),(0,s.jsx)("p",{className:"text-xs text-text-secondary capitalize",children:e.status})]})]})},e.id))})]})})]})]})})})}}},e=>{e.O(0,[680,661,201,637,223,956,674,718,795,358],()=>e(e.s=1650)),_N_E=e.O()}]);